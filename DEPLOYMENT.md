#CI/CDandDockerDeploymentGuide##OverviewThisprojectincludescompleteCI/CDpipelineandKubernetesdeploymentconfigurationsforproduction-gradedeployment.##Components###1.GitHubActionsCI/CDPipeline**Location**:`.github/workflows/ci-cd.yml`**Features**:-Javabuild&test(Maven)-Pythonbuild&test(pytest)-Securityscanning(Trivy,OWASP)-Dockerimagebuilding(multi-platform)-PushtoDockerHub&AWSECR-Kubernetesdeployment(EKS)-Healthchecks&smoketests-Performancetesting(k6)**WorkflowTriggers**:-Pushto`main`,`develop`,`feature/*`-Pullrequeststo`main`,`develop`-Releasetags###2.DockerImages####JavaServiceDockerfile**Location**:`BankFraudTest/Dockerfile`**Features**:-Multi-stagebuild(Mavenbuild→JREruntime)-Java21withG1GCoptimization-Non-rootuserforsecurity-Healthcheckendpoint-OptimizedJVMsettings####PythonAPIDockerfile**Location**:`LLM/Dockerfile`**Features**:-Python3.8-slimbase-TesseractOCRfordocumentparsing-Multi-servicesupport(API+Dashboard)-Modelcaching-ProductionASGIserver(uvicorn)###3.KubernetesDeployments**Location**:`k8s/`**Resources**:-`namespace.yaml`-Isolatednamespace-`configmap.yaml`-Configurationvalues-`secrets.yaml`-Sensitivedata(template)-`postgres-deployment.yaml`-PostgreSQLwithPVC-`java-service-deployment.yaml`-JavaservicewithHPA-`python-api-deployment.yaml`-PythonAPIwithHPA-`ingress.yaml`-Loadbalancer&routing**Features**:-HorizontalPodAutoscaling(HPA)-Healthchecks(liveness&readiness)-Resourcelimits&requests-Rollingupdates(zerodowntime)-Podanti-affinityforHA-Servicemeshready##QuickStart###LocalDevelopmentwithDockerCompose```bash#Buildandstartallservicesdocker-composeup-d#Viewlogsdocker-composelogs-f#Stopservicesdocker-composedown```###BuildDockerImages```bash#Runbuildscriptchmod+xscripts/build-and-push.sh./scripts/build-and-push.sh#Ormanuallydockerbuild-thermantqin/financial-java-service:latest-fBankFraudTest/Dockerfile./BankFraudTestdockerbuild-thermantqin/financial-python-api:latest-fLLM/Dockerfile./LLM```###DeploytoKubernetes```bash#Rundeploymentscriptchmod+xk8s/deploy-all.sh./k8s/deploy-all.sh#Ormanuallykubectlapply-fk8s/namespace.yamlkubectlapply-fk8s/configmap.yamlkubectlapply-fk8s/secrets.yamlkubectlapply-fk8s/postgres-deployment.yamlkubectlapply-fk8s/java-service-deployment.yamlkubectlapply-fk8s/python-api-deployment.yamlkubectlapply-fk8s/ingress.yaml```##GitHubActionsSetup###RequiredSecretsAddthesesecretstoyourGitHubrepository:**DockerHub**(Settings→Secrets→Actions):```DOCKER_USERNAME=your-dockerhub-usernameDOCKER_PASSWORD=your-dockerhub-password```**AWS**(forECR&EKS):```AWS_ACCESS_KEY_ID=your-access-keyAWS_SECRET_ACCESS_KEY=your-secret-key```**LLMAPIKeys**:```GOOGLE_API_KEY=your-google-api-keyGROQ_API_KEY=your-groq-api-keyOPENROUTER_API_KEY=your-openrouter-key```**Notifications**(optional):```SLACK_WEBHOOK=your-slack-webhook-url```###TriggerWorkflow```bash#PushtotriggerCI/CDgitadd.gitcommit-m"TriggerCI/CDpipeline"gitpushoriginmain#Orcreateatagforreleasegittagv1.0.0gitpushoriginv1.0.0```##DockerRegistryOptions###Option1:DockerHub(Public/Private)```bash#Logindockerlogin#Pushimagesdockerpushhermantqin/financial-java-service:latestdockerpushhermantqin/financial-python-api:latest#Pullimagesdockerpullhermantqin/financial-java-service:latestdockerpullhermantqin/financial-python-api:latest```**Advantages**:-Freeforpublicimages-Easytouse-Goodforpersonalprojects###Option2:AWSECR(Private)```bash#LogintoECRawsecrget-login-password--regionus-east-1|\dockerlogin--usernameAWS--password-stdin<account-id>.dkr.ecr.us-east-1.amazonaws.com#Createrepositoriesawsecrcreate-repository--repository-namefinancial-java-serviceawsecrcreate-repository--repository-namefinancial-python-api#Tagimagesdockertaghermantqin/financial-java-service:latest\<account-id>.dkr.ecr.us-east-1.amazonaws.com/financial-java-service:latest#Pushimagesdockerpush<account-id>.dkr.ecr.us-east-1.amazonaws.com/financial-java-service:latest```**Advantages**:-Privatebydefault-IntegratedwithEKS-Highavailability-Imagescanningincluded###Option3:GitHubContainerRegistry```bash#Loginecho$GITHUB_TOKEN|dockerloginghcr.io-uUSERNAME--password-stdin#Tagimagesdockertaghermantqin/financial-java-service:latest\ghcr.io/hermanqin9/financial-java-service:latest#Pushimagesdockerpushghcr.io/hermanqin9/financial-java-service:latest```##KubernetesClusterSetup###AWSEKS```bash#Installeksctlcurl--silent--location"https://github.com/weaveworks/eksctl/releases/latest/download/eksctl_$(uname-s)_amd64.tar.gz"|tarxz-C/tmpsudomv/tmp/eksctl/usr/local/bin#Createclustereksctlcreatecluster\--namefinancial-platform-cluster\--regionus-east-1\--nodegroup-namestandard-workers\--node-typet3.medium\--nodes3\--nodes-min2\--nodes-max5\--managed#Updatekubeconfigawseksupdate-kubeconfig--regionus-east-1--namefinancial-platform-cluster#InstallAWSLoadBalancerControllerhelmrepoaddekshttps://aws.github.io/eks-chartshelminstallaws-load-balancer-controllereks/aws-load-balancer-controller\-nkube-system\--setclusterName=financial-platform-cluster```###GoogleGKE```bash#Createclustergcloudcontainerclusterscreatefinancial-platform-cluster\--regionus-central1\--num-nodes3\--machine-typen1-standard-2\--enable-autoscaling\--min-nodes2\--max-nodes5#Getcredentialsgcloudcontainerclustersget-credentialsfinancial-platform-cluster--regionus-central1```###LocalTesting(Minikube)```bash#Startminikubeminikubestart--cpus=4--memory=8192--driver=docker#Enableingressminikubeaddonsenableingress#Deploykubectlapply-fk8s/#Accessservicesminikubeservicejava-service-nfinancial-platform```##Monitoring&Observability###Prometheus+Grafana```bash#InstallwithHelmhelmrepoaddprometheus-communityhttps://prometheus-community.github.io/helm-chartshelminstallprometheusprometheus-community/kube-prometheus-stack-nmonitoring--create-namespace```###ViewMetrics```bash#CPU/Memoryusagekubectltoppods-nfinancial-platformkubectltopnodes#HPAstatuskubectlgethpa-nfinancial-platform#Resourceeventskubectlgetevents-nfinancial-platform--sort-by='.lastTimestamp'```##Troubleshooting###PipelineFailures**Javatestsfailing**:```bash#RunlocallycdBankFraudTestmvncleantest```**Pythontestsfailing**:```bash#RunlocallycdLLMpipinstall-rrequirements.txtpytesttests/```**Dockerbuildfailing**:```bash#Buildlocallywithverboseoutputdockerbuild--progress=plain-fBankFraudTest/Dockerfile./BankFraudTest```###KubernetesIssues**Podsnotstarting**:```bashkubectldescribepod<pod-name>-nfinancial-platformkubectllogs<pod-name>-nfinancial-platform```**Serviceunreachable**:```bash#Testfromwithinclusterkubectlruntest--rm-i--restart=Never--image=curlimages/curl--\curlhttp://java-service.financial-platform.svc.cluster.local:8080/health```**Imagepullerrors**:```bash#Checkifimageexistsdockerpullhermantqin/financial-java-service:latest#Checkimagepullsecretskubectlgetsecrets-nfinancial-platform```##PerformanceTuning###JavaService**JVMOptions**(inConfigMap):```JAVA_OPTS:"-Xms1g-Xmx2g-XX:+UseG1GC-XX:MaxGCPauseMillis=200"```###PythonAPI**UvicornWorkers**(inDockerfileCMD):```CMD["uvicorn","app.api:app","--host","0.0.0.0","--workers","4"]```###Database**ConnectionPool**(inConfigMap):```HIKARI_MAX_POOL_SIZE:"50"HIKARI_MIN_IDLE:"20"```##SecurityBestPractices1.**Non-rootcontainers**-BothDockerfilesusededicatedappusers2.**Secretmanagement**-Kubernetessecretsforsensitivedata3.**Imagescanning**-TrivyscansinCI/CDpipeline4.**Networkpolicies**-Restrictpod-to-podcommunication5.**RBAC**-Role-basedaccesscontrolforK8s6.**TLS/HTTPS**-IngresswithSSLcertificates##CostOptimization**AWSEKS**:-UseSpotInstancesfornon-criticalworkloads-EnableClusterAutoscaler-UseFargateforserverlesspods**Resources**:```yamlresources:requests:memory:"512Mi"#Startsmallcpu:"250m"limits:memory:"1Gi"#PreventOOMcpu:"500m"```##CI/CDWorkflowDiagram```┌─────────────┐│GitPush│└──────┬──────┘│v┌─────────────────────────────────────┐│GitHubActionsTriggered│└──────┬──────────────────────────────┘│├──>JavaBuild&Test├──>PythonBuild&Test├──>SecurityScan│v┌─────────────────────────────────────┐│BuildDockerImages││-JavaService││-PythonAPI│└──────┬──────────────────────────────┘│├──>PushtoDockerHub├──>PushtoAWSECR│v┌─────────────────────────────────────┐│DeploytoKubernetes(EKS)││-Updatedeployments││-Rollingupdate││-Healthchecks│└──────┬──────────────────────────────┘│v┌─────────────────────────────────────┐│Verification&Monitoring││-Smoketests││-Sendnotifications│└─────────────────────────────────────┘```##NextSteps1.**SetupGitHubSecrets**forCI/CD2.**CreateKubernetescluster**(EKS/GKE/AKS)3.**Rundeploymentscript**:`./k8s/deploy-all.sh`4.**Configuremonitoring**(Prometheus/Grafana)5.**Setupalerts**(Slack/PagerDuty)6.**Implementbackupstrategy**7.**ConfigureCDN**(CloudFront/CloudFlare)##SupportForissuesorquestions:-CreateGitHubIssue-Contact:hermantqin@gmail.com-Documentation:`k8s/README.md`